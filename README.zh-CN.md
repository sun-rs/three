# Three

[![English](https://img.shields.io/badge/lang-English-lightgrey)](README.md)
[![ä¸­æ–‡](https://img.shields.io/badge/è¯­è¨€-ä¸­æ–‡-blue)](README.zh-CN.md)

> **é¢å‘å¤æ‚è½¯ä»¶ä»»åŠ¡çš„å¤šæ™ºèƒ½ä½“ã€å¤šå¤§æ¨¡å‹ç¼–æ’ç³»ç»Ÿ**

Three æ˜¯é¢å‘ Codexã€Geminiã€Claude çš„å¤šæ™ºèƒ½ä½“ã€å¤šå¤§æ¨¡å‹ CLIï¼ˆMCP server + æ’ä»¶ï¼‰ã€‚

å®ƒé¢å‘çœŸå®å·¥ç¨‹åä½œåœºæ™¯ï¼Œé‡ç‚¹è§£å†³â€œå¤æ‚ä»»åŠ¡å¦‚ä½•é«˜è´¨é‡æ”¶æ•›â€ï¼š
- ç”¨ `/three:conductor` æ‹†è§£å¤æ‚ä»»åŠ¡å¹¶åˆ†æ´¾ç»™å¤šä¸ªä¸“ä¸šè§’è‰²ã€‚
- ç”¨ `/three:roundtable` å‘èµ· 1-3 è½®åé¦ˆè®¨è®ºï¼Œä¸» CLI æœ€ç»ˆæ”¶æ•›ç»“è®ºã€‚
- ç”¨ `mcp__three__batch` å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹å­ä»»åŠ¡ï¼Œå…è®¸éƒ¨åˆ†å¤±è´¥ä½†ä¿ç•™å¯ç”¨ç»“æœã€‚
- é€šè¿‡ `client` + `conversation_id`ï¼ˆå¯é€‰ï¼‰åšå­ä¼šè¯éš”ç¦»ï¼Œé™ä½è·¨å¯¹è¯æ±¡æŸ“é£é™©ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© Threeï¼Ÿ

é«˜æ•ˆçš„å·¥ç¨‹å®è·µéœ€è¦å¤šä¸ªè§†è§’ï¼š

- **ğŸ”® Oracleï¼ˆé¢„è¨€å®¶ï¼‰** â€” æ¶æ„è®¾è®¡ã€æƒè¡¡åˆ†æã€é•¿æœŸé£é™©
- **ğŸ”¨ Builderï¼ˆå»ºé€ è€…ï¼‰** â€” å®ç°å¯è¡Œæ€§ã€æ­£ç¡®æ‰§è¡Œ
- **ğŸ” Researcherï¼ˆç ”ç©¶å‘˜ï¼‰** â€” ä»£ç åº“å’Œæ–‡æ¡£æ£€ç´¢
- **âœ… Reviewerï¼ˆå®¡æŸ¥å‘˜ï¼‰** â€” è´¨é‡å’Œæ­£ç¡®æ€§æ£€æŸ¥
- **âš¡ Criticï¼ˆæ‰¹è¯„å®¶ï¼‰** â€” é€†å‘é£é™©åˆ†æ
- **ğŸš€ Sprinterï¼ˆå†²åˆºè€…ï¼‰** â€” å¿«é€Ÿåˆ›æ„ç”Ÿæˆ

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ è§’è‰²åŒ–æ™ºèƒ½ä½“
ä¸“ä¸šåŒ–æ™ºèƒ½ä½“ï¼Œå…·å¤‡ä¼šè¯æ„ŸçŸ¥å¤ç”¨å’Œå®‰å…¨èƒ½åŠ›æ§åˆ¶ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€Shellã€ç½‘ç»œã€å·¥å…·ï¼‰ã€‚

### ğŸ”„ è·¨æ¨¡å‹éªŒè¯
å°†å¤æ‚ä»»åŠ¡åˆ†é…ç»™å¤šä¸ªå¤§æ¨¡å‹ï¼Œäº¤å‰éªŒè¯ç»“æœï¼Œä»¥æ›´å°‘çš„æç¤ºè¯å¼€é”€æ›´å¿«æ”¶æ•›ã€‚

### ğŸ¤ åœ†æ¡Œå…±è¯†
è¿è¡Œå¤šè½®è®¨è®ºï¼Œè®©ä¸åŒæ¨¡å‹è¾©è®ºå¹¶ç»¼åˆå†³ç­–ï¼Œç”¨äºè‰°éš¾çš„æ¶æ„é€‰æ‹©ã€‚

### âš¡ å¹¶è¡Œæ‰‡å‡º
å¹¶å‘æ‰§è¡Œç‹¬ç«‹ä»»åŠ¡ï¼Œæ”¯æŒéƒ¨åˆ†å¤±è´¥å¤„ç†ï¼Œå¹¶é»˜è®¤è¾“å‡ºå®æ—¶è§’è‰²å®Œæˆè¿›åº¦ã€‚

## å¿«é€Ÿå‘½ä»¤

- **`/three:conductor <task>`** â€” ç¼–æ’å¤æ‚å·¥ä½œå¹¶å†³å®šä½•æ—¶ä½¿ç”¨åœ†æ¡Œè®¨è®º
- **`/three:roundtable <topic>`** â€” å¤šè§’è‰²å…±è¯†å·¥ä½œæµï¼ˆ1-3 è½®ï¼‰
- **`/three:oracle <task>`** â€” æ¶æ„å’Œæƒè¡¡åˆ†æ
- **`/three:builder <task>`** â€” å®ç°å’Œè°ƒè¯•
- **`/three:reviewer <request>`** â€” ä»£ç å®¡æŸ¥å’Œé£é™©å‘ç°

## ç›®å½•ç»“æ„

- `mcp-server-three/` â€” MCP Serverï¼ˆRustï¼‰ã€‚è´Ÿè´£å°†è¯·æ±‚è·¯ç”±åˆ°é…ç½®çš„åç«¯ï¼Œå¹¶è¿›è¡Œä¼šè¯å¤ç”¨ã€‚
- `plugins/claude-code/three/` â€” Claude Code æ’ä»¶ï¼ˆæ–œæ å‘½ä»¤ + è·¯ç”±æŠ€èƒ½ï¼‰ã€‚

## æ–‡æ¡£ç´¢å¼•

- `docs/cli-output-modes.md` â€” è¾“å‡º/æµå¼è§£æè§„åˆ™ï¼ˆæƒå¨å…¥å£ï¼‰
- `docs/cli-*.md` â€” å„ CLI çš„å‚æ•°æ˜ å°„ã€ä¼šè¯ç»­æ¥å’Œç‰¹æ€§è¯´æ˜
- `docs/config-schema.md` â€” é…ç½®å­—æ®µã€é»˜è®¤å€¼ä¸è§£æè§„åˆ™

å®¢æˆ·ç«¯ä¸“ç”¨é…ç½®ï¼šå½“ MCP `client` å‚æ•°ï¼ˆæˆ– `THREE_CLIENT`ï¼‰å­˜åœ¨æ—¶ï¼Œä¼˜å…ˆåŠ è½½ `config-<client>.json`ã€‚

## CLI é€‚é…çŸ©é˜µ

è¯´æ˜ï¼š`examples/config.json` æ˜¯â€œæŠ€æœ¯é…ç½®-onlyâ€æ¨¡æ¿ï¼ˆä¸åŒ…å« persona è¦†ç›–ï¼‰ã€‚
å†…ç½® persona å¯é€šè¿‡ `roles.<id>.personas` è¦†ç›–ï¼ˆæœ€å°ç¤ºä¾‹è§ `docs/config-schema.md`ï¼‰ã€‚
Personas å†…ç½®äº MCP Serverï¼›`roles.<id>.personas` ä¸ºå¯é€‰è¦†ç›–é¡¹ã€‚
å¦‚æœä¸» CLI æ˜¯ Codexï¼Œå¯å‚è€ƒ `examples/config-codex.json`ï¼ˆé»˜è®¤é¿å…è‡ªè°ƒç”¨ Codexï¼‰ã€‚

æ‰€æœ‰åç«¯éƒ½ç”±å†…ç½®çš„ adapter catalog é©±åŠ¨ï¼ˆMiniJinja `args_template` + `output_parser`ï¼‰ã€‚  
æ¨¡å‹å†™æ³•ä¸º `backend/model@variant`ï¼ˆvariant å¯é€‰ï¼‰ã€‚variant ä¼šè¦†ç›– `options`ï¼Œ
ä½†åªæœ‰å½“ adapter å°†è¿™äº› options æ˜ å°„æˆ CLI å‚æ•°æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚è‹¥ adapter å£°æ˜äº†
`filesystem_capabilities`ï¼Œä¸æ”¯æŒçš„å€¼ä¼šåœ¨ **æŒ‰ role è§£æ**æ—¶å¤±è´¥ã€‚

| Backendï¼ˆCLIï¼‰ | å¯æ§è¯»å†™èƒ½åŠ› | é…ç½® â†’ CLI å‚æ•° | æ¨¡å‹ ID å‘½å | options/variants æ˜ å°„ | è¾“å‡ºè§£æä¸ä¼šè¯ |
|---|---|---|---|---|---|
| codex | read-only, read-write | `--sandbox read-only` / `--sandbox workspace-write` | `codex/<model>@variant` | æ˜ å°„ä¸º `-c key=value`ï¼ˆvariant æœ€ç»ˆå˜æˆ `-c`ï¼‰ï¼Œå¦‚ `model_reasoning_effort`ã€`text_verbosity` | `json_stream`ï¼ˆ`thread_id`, `item.text`ï¼‰ï¼Œæ”¯æŒ session |
| claude | read-only, read-write | `--permission-mode plan` / `--dangerously-skip-permissions` | `claude/<model>@variant` | é»˜è®¤ä¸æ˜ å°„ï¼ˆéœ€æ‰©å±• adapterï¼‰ | `json_object`ï¼ˆ`session_id`, `result`ï¼‰ï¼Œæ”¯æŒ session |
| gemini | read-only, read-write | `--approval-mode plan` + `--sandbox` / `-y` | `gemini/<model>@variant` | é»˜è®¤ä¸æ˜ å°„ï¼ˆéœ€æ‰©å±• adapterï¼‰ | `json_object`ï¼ˆ`session_id`, `response`ï¼‰ï¼Œæ”¯æŒ session |
| opencode | ä»… read-write | æ—  read-only å‚æ•°ï¼ˆread-only ä¼šè¢«æ‹’ç»ï¼‰ | `opencode/<provider>/<model>@variant` | é»˜è®¤ä¸æ˜ å°„ï¼ˆéœ€æ‰©å±• adapterï¼‰ | `json_stream`ï¼ˆ`part.sessionID`, `part.text`ï¼‰ï¼Œæ”¯æŒ session |
| kimi | ä»… read-write | æ—  read-only å‚æ•°ï¼ˆread-only ä¼šè¢«æ‹’ç»ï¼‰ | `kimi/<model>@variant` | é»˜è®¤ä¸æ˜ å°„ï¼ˆéœ€æ‰©å±• adapterï¼‰ | `text`ï¼ˆstatelessï¼‰ï¼Œä¸æ”¯æŒ session id |

Adapter è¯´æ˜ï¼š
- adapter catalog å†…ç½®äºæœåŠ¡å™¨ï¼ˆä¸å†ä½¿ç”¨ `adapter.json` é…ç½®æ–‡ä»¶ï¼‰ã€‚
- `args_template` æ˜¯ token åˆ—è¡¨ï¼Œç©º token ä¼šè¢«ä¸¢å¼ƒã€‚
- `include_directories` ä¼šä» prompt ä¸­çš„ç»å¯¹è·¯å¾„è‡ªåŠ¨æ¨å¯¼ï¼ˆGeminiï¼‰ã€‚
- æ‰€æœ‰å†…ç½®é€‚é…å™¨é»˜è®¤å¯ç”¨ `prompt_transport=auto`ï¼šé•¿ prompt ä¼šæ”¹ç”¨ `stdin` ä¼ é€’ï¼ˆä¸æ··ç”¨ argv+stdinï¼‰ã€‚
- `json_stream` å¯é€‰å¯ç”¨ `fallback=codex`ï¼Œç”¨äºåœ¨ç¼ºå¤± `message_path` æ—¶å›é€€è§£æã€‚
- `backend.<id>.fallback` å¯åœ¨æ¨¡å‹ä¸å­˜åœ¨æ—¶è‡ªåŠ¨å›é€€ï¼ˆå¯è·¨ backendï¼‰ã€‚

## å¿«é€Ÿå¼€å§‹

1) æ„å»º MCP Serverï¼š

```bash
cd mcp-server-three
cargo build --release
```

æ³¨æ„ï¼šç¼–è¯‘äº§ç‰©ä¸º `target/release/mcp-server-three`ï¼Œæ³¨å†Œçš„ MCP server åç§°ä»å¯ä½¿ç”¨ `three`ã€‚

2) åœ¨ Claude Code æ³¨å†Œ MCP Serverï¼š

```bash
claude mcp add three -s user --transport stdio -- \
  "$(pwd)/target/release/mcp-server-three"
```

3) å®‰è£… Claude Code æ’ä»¶ï¼š

```bash
claude plugin marketplace add "./plugins/claude-code"
claude plugin install three@three-local
```

4) ä½¿ç”¨æ’ä»¶å‘½ä»¤ï¼š
- `/three:conductor <task>` è¿›è¡Œä»»åŠ¡ç¼–æ’
- `/three:roundtable <topic>` è¿›è¡Œå¤šè§’è‰²è®¨è®º
- `/three:oracle|builder|researcher|reviewer|critic|sprinter <task>` ç›´æ¥è°ƒç”¨ä¸“ä¸šè§’è‰²

å¹¶è¡Œæ‰‡å‡ºï¼šä½¿ç”¨ `mcp__three__batch` åœ¨ä¸€æ¬¡ MCP è°ƒç”¨ä¸­å¹¶è¡Œæ‰§è¡Œå¤šä¸ªç‹¬ç«‹ä»»åŠ¡ï¼ˆå³ä½¿éƒ¨åˆ†å¤±è´¥ä¹Ÿä¼šè¿”å›ç»“æœï¼‰ã€‚

## è¯´æ˜

- MCP Server æ˜¯å®¿ä¸»æ— å…³çš„ï¼Œåªè¦ CLI æ”¯æŒ MCP å°±èƒ½ä½¿ç”¨ã€‚
- æ’ä»¶æ˜¯å®¿ä¸»ç‰¹å®šçš„ï¼Œå»ºè®®æ–°å¢åœ¨ `plugins/<cli>/`ã€‚
